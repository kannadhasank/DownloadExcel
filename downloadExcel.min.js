function JSONToCSVConvertor(e,t){for(var a="object"!=typeof e?JSON.parse(e):e,d="",n=0;n<a.length;n++){var o="";for(var i in a[n])o+='"'+a[n][i]+'"	';o.slice(0,o.length-1),d+=o+"\r\n"}if(""==d)return void alert("Invalid data");var l="";l+=t.replace(/ /g,"_");var r="data:text/xls;charset=utf-8,"+escape(d),c=document.createElement("a");c.href=r,c.style="visibility:hidden",c.download=l+".xls",document.body.appendChild(c),c.click(),document.body.removeChild(c)}$.fn.downloadExcel=function(e){table=$(this),data=[],i=0,e="undefined"==typeof e?"Table":e,"undefined"!=typeof dataTable&&$.isFunction(dataTable)?(dT=table.dataTable(),rows=dT.$("tr",{filter:"applied"})):rows=table.find("tr"),len=rows.length,rows.each(function(){i++,dd=[],$(this).find("td").each(function(){dd.push($(this).text())}),data.push(dd),len==i&&JSONToCSVConvertor(data,e,!1)})};
